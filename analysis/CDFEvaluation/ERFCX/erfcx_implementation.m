function r = erfcx_implementation(x)
    a = max (x, 0.0 - x);
    m = a - 4.0;
    p = a + 4.0;
    r = 1.0 ./ p;
    q = m .* r;
    t = fma (q + 1.0, -4.0, a);
    e = fma (q, -a, t);
    q = fma (r, e, q);
    
    p =             8.9820305531190140e-10;
    p = fma (p, q,  1.5764464777959401e-09);
    p = fma (p, q, -1.2155985739342269e-08);
    p = fma (p, q, -1.6386753783877791e-08);
    p = fma (p, q,  1.0585794011876720e-07);
    p = fma (p, q,  7.1190423171700940e-08);
    p = fma (p, q, -8.2040389712752056e-07);
    p = fma (p, q,  2.9796165315625938e-07);
    p = fma (p, q,  5.7059822144459833e-06);
    p = fma (p, q, -1.1225056665965572e-05);
    p = fma (p, q, -2.4397380523258482e-05);
    p = fma (p, q,  1.5062307184282616e-04);
    p = fma (p, q, -1.9925728768782324e-04);
    p = fma (p, q, -7.5777369791018515e-04);
    p = fma (p, q,  5.0319701025945277e-03);
    p = fma (p, q, -1.6197733983519948e-02);
    p = fma (p, q,  3.7167515521269866e-02);
    p = fma (p, q, -6.6330365820039094e-02);
    p = fma (p, q,  9.3732834999538536e-02);
    p = fma (p, q, -1.0103906603588378e-01);
    p = fma (p, q,  6.8097054254651804e-02);
    p = fma (p, q,  1.5379652102610957e-02);
    p = fma (p, q, -1.3962111684056208e-01);
    p = fma (p, q,  2.3299511862555250e-01);

    d = a + 0.5;
    r = 1.0 ./ d;
    r = r .* 0.5;
    q = fma (p, r, r); 
    t = q + q;
    e = (p - q) + fma (t, -a, 1.0); 
    r = fma (e, r, q);

    r(a > realmax) = 0.0;

    k = x < 0.0;
    if any(k)
        s = x(k).*x(k);
        d = fma(x(k), x(k), -s);
        e = exp(s);
        R = e - r(k);
        R = fma(e, d + d, R);
        R = R + e;
        R(e > realmax) = e(e > realmax);
        r(k) = R;
    end    
end

% function f = fma(a,b,c)
%     f = a.*b + c;
% end